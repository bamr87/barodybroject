<!-- generated_content.html -->
{% extends "base.html" %}
{% load markdownify %}

{% block content %}
<div class="container mt-4" id="content-create">
    <h2>Generate the content for the post</h2>
    <form method="post" action="{% url 'manage_content' %}">
        {% csrf_token %}
        <div class="row">
            <!-- Role Selection and Instructions Column -->
            <div class="col-md-6">
                {{ form.role_name.label_tag }}<br>
                {{ form.role_name }}<br>
                <div id="role_text_div">
                    {{ form.instructions.label_tag }}<br>
                    <div style="display: none;">
                        {{ form.system_role }}<br>
                    </div>
                    {{ form.instructions }}
                </div>
            </div>
            <!-- Prompt Column -->
            <div class="col-md-6">
                {{ form.prompt.label_tag }}<br>
                {{ form.prompt }}
                <div>
                </div>
            </div>
            <button type="submit" class="btn btn-primary mt-3">Submit</button>
        </div>
    </form>
</div>

    <div class="container mt-5">
        <h1>Generated Content</h1>
        {% if generated_content %}
            <div class="mt-3">
                <h2>Content:</h2>
                {% for content in generated_content %}
                    <div class="row">
                        <div class="col-12">
                            <div class="card mb-3">
                                <div class="card-body">
                                    <p><strong>Prompt:</strong> {{ content.prompt|linebreaksbr }}</p>
                                    <!-- Use the markdownify filter to render Markdown content as HTML -->
                                    <!-- Additionally, use the linebreaksbr filter to retain new lines or blank lines -->
                                    <div><strong>Content:</strong> <br>
                                        <div data-content-id="{{ content.id }}">
                                            {{ content.content|markdownify|linebreaksbr }}
                                        </div>
                                        <!-- Inside the loop for content items -->
                                        <div class="card-footer">
                                            <form action="{% url 'create_message' %}" method="POST">
                                                {% csrf_token %}
                                                <input type="hidden" name="content_id" value="{{ content.id }}">
                                                <button type="submit">Create New Message</button>
                                            </form>
                                            <!-- Edit Button -->
                                            <button type="button" class="edit-btn" data-content-id="{{ content.id }}">Edit</button>
                                            <!-- Save and Cancel Buttons (hidden by default) -->
                                            <button type="button" class="save-btn" data-content-id="{{ content.id }}" style="display:none;">Save</button>
                                            <button type="button" class="cancel-btn" style="display:none;">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No content has been generated yet.</p>
        {% endif %}
        <a href="/" class="btn btn-primary mt-3">Return to Home</a>
    </div>


{% load static %}
<script src="{% static 'js/content_detail.js' %}"></script>

{% endblock %}
